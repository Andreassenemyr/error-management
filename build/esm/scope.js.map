{"version":3,"file":"scope.js","sources":["../../src/scope.ts"],"sourcesContent":["import { logger } from \"./utils/logger\";\r\nimport { CaptureContext, Extra, Extras, ScopeContext, Scope as ScopeInterface } from \"./index\";\r\nimport { RequestSession, Session } from \"./session\";\r\nimport { Client } from \"./client\";\r\nimport { Event, EventHint, SeverityLevel } from \"./types\";\r\nimport { v4 as uuid4 } from \"uuid\";\r\nimport { isPlainObject } from \"./utils/object\";\r\n\r\nexport interface ScopeData {\r\n    tags: { [key: string]: Primitive };\r\n    extra: Extras;\r\n    sdkProcessingMetadata: { [key: string]: unknown };\r\n    fingerprint: string[];\r\n    level?: SeverityLevel;\r\n    transactionName?: string;\r\n}\r\n\r\nexport type Primitive = number | string | boolean | bigint | symbol | null | undefined;\r\n\r\nexport class Scope implements ScopeInterface {\r\n    /** Flag if notifying is happening. */\r\n    protected _notifyingListeners: boolean;\r\n\r\n    /** Callback for client to receive scope changes. */\r\n    protected _scopeListeners: Array<(scope: Scope) => void>;\r\n\r\n    protected _level?: SeverityLevel;\r\n\r\n    /** Tags */\r\n    protected _tags: { [key: string]: Primitive };\r\n\r\n    /** Extra */\r\n    protected _extra: Extras;\r\n\r\n    /**\r\n     * A place to stash data which is needed at some point in the SDK's event processing pipeline but which shouldn't get\r\n     * sent to Ribban\r\n     */\r\n    protected _sdkProcessingMetadata: { [key: string]: unknown };\r\n\r\n    /** Fingerprint */\r\n    protected _fingerprint?: string[];\r\n    /**\r\n     * Transaction Name\r\n     *\r\n     * IMPORTANT: The transaction name on the scope has nothing to do with root spans/transaction objects.\r\n     * It's purpose is to assign a transaction to the scope that's added to non-transaction events.\r\n     */\r\n    protected _transactionName?: string;\r\n\r\n    /** Session */\r\n    protected _session?: Session;\r\n\r\n    /** Request Mode Session Status */\r\n    protected _requestSession?: RequestSession;\r\n\r\n    /** The client on this scope */\r\n    protected _client?: Client;\r\n\r\n    // NOTE: Any field which gets added here should get added not only to the constructor but also to the `clone` method.\r\n\r\n    public constructor() {\r\n        this._notifyingListeners = false;\r\n        this._scopeListeners = [];\r\n        this._tags = {};\r\n        this._extra = {};\r\n        this._sdkProcessingMetadata = {};\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public clone(): Scope {\r\n        const newScope = new Scope();\r\n        newScope._tags = { ...this._tags };\r\n        newScope._extra = { ...this._extra };\r\n        newScope._session = this._session;\r\n        newScope._transactionName = this._transactionName;\r\n        newScope._fingerprint = this._fingerprint;\r\n        newScope._requestSession = this._requestSession;\r\n        newScope._sdkProcessingMetadata = { ...this._sdkProcessingMetadata };\r\n        newScope._client = this._client;\r\n\r\n        return newScope;\r\n    }\r\n\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public getClient<C extends Client>(): C | undefined {\r\n        return this._client as C | undefined;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public getRequestSession(): RequestSession | undefined {\r\n        return this._requestSession;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setRequestSession(requestSession?: RequestSession): this {\r\n        this._requestSession = requestSession;\r\n        return this;\r\n    }\r\n\r\n    addScopeListener(callback: (scope: ScopeInterface) => void): void {\r\n        this._scopeListeners.push(callback);\r\n    }\r\n\r\n    public setClient(client: Client | undefined): void {\r\n        this._client = client;\r\n    }\r\n\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setTags(tags: { [key: string]: Primitive }): this {\r\n        this._tags = {\r\n            ...this._tags,\r\n            ...tags,\r\n        };\r\n        this._notifyScopeListeners();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setTag(key: string, value: Primitive): this {\r\n        this._tags = { ...this._tags, [key]: value };\r\n        this._notifyScopeListeners();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setExtras(extras: Extras): this {\r\n        this._extra = {\r\n            ...this._extra,\r\n            ...extras,\r\n        };\r\n        this._notifyScopeListeners();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setExtra(key: string, extra: Extra): this {\r\n        this._extra = { ...this._extra, [key]: extra };\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setFingerprint(fingerprint: string[]): this {\r\n        this._fingerprint = fingerprint;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setLevel(level: SeverityLevel): this {\r\n        this._level = level;\r\n        this._notifyScopeListeners();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setTransactionName(name?: string): this {\r\n        this._transactionName = name;\r\n        this._notifyScopeListeners();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setSession(session?: Session): this {\r\n        if (!session) {\r\n            delete this._session;\r\n        } else {\r\n            this._session = session;\r\n        }\r\n        this._notifyScopeListeners();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public getSession(): Session | undefined {\r\n        return this._session;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public update(captureContext?: CaptureContext): this {\r\n        if (!captureContext) {\r\n            return this;\r\n        }\r\n\r\n        const scopeToMerge = typeof captureContext === 'function' ? captureContext(this) : captureContext;\r\n\r\n        const [scopeInstance, requestSession] =\r\n            scopeToMerge instanceof Scope\r\n                ? [scopeToMerge.getScopeData(), scopeToMerge.getRequestSession()]\r\n                : isPlainObject(scopeToMerge)\r\n                    ? [captureContext as ScopeContext, (captureContext as ScopeContext).requestSession]\r\n                    : [];\r\n\r\n        const { tags, extra, level, fingerprint = [] } = scopeInstance || {};\r\n\r\n        this._tags = { ...this._tags, ...tags };\r\n        this._extra = { ...this._extra, ...extra };\r\n\r\n\r\n        if (level) {\r\n            this._level = level;\r\n        }\r\n\r\n        if (fingerprint.length) {\r\n            this._fingerprint = fingerprint;\r\n        }\r\n\r\n        if (requestSession) {\r\n            this._requestSession = requestSession;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public clear(): this {\r\n        // client is not cleared here on purpose!\r\n        this._tags = {};\r\n        this._extra = {};\r\n        this._level = undefined;\r\n        this._transactionName = undefined;\r\n        this._fingerprint = undefined;\r\n        this._requestSession = undefined;\r\n        this._session = undefined;\r\n\r\n        this._notifyScopeListeners();\r\n        return this;\r\n    }\r\n\r\n    /** @inheritDoc */\r\n    public getScopeData(): ScopeData {\r\n        return {\r\n            tags: this._tags,\r\n            extra: this._extra,\r\n            level: this._level,\r\n            fingerprint: this._fingerprint || [],\r\n            sdkProcessingMetadata: this._sdkProcessingMetadata,\r\n            transactionName: this._transactionName,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public setSDKProcessingMetadata(newData: { [key: string]: unknown }): this {\r\n        this._sdkProcessingMetadata = { ...this._sdkProcessingMetadata, ...newData };\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public captureException(exception: unknown, hint?: EventHint): string {\r\n        const eventId = hint && hint.event_id ? hint.event_id : uuid4();\r\n\r\n        if (!this._client) {\r\n            console.warn('No client configured on scope - will not capture exception!');\r\n            return eventId;\r\n        }\r\n\r\n        const syntheticException = new Error('Ribban syntheticException');\r\n\r\n        this._client.captureException(\r\n            exception,\r\n            {\r\n                originalException: exception,\r\n                syntheticException,\r\n                ...hint,\r\n                event_id: eventId,\r\n            },\r\n            this,\r\n        );\r\n\r\n        return eventId;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public captureMessage(message: string, level?: SeverityLevel, hint?: EventHint): string {\r\n        const eventId = hint && hint.event_id ? hint.event_id : uuid4();\r\n\r\n        if (!this._client) {\r\n            console.warn('No client configured on scope - will not capture message!');\r\n            return eventId;\r\n        }\r\n\r\n        const syntheticException = new Error(message);\r\n\r\n        this._client.captureMessage(\r\n            message,\r\n            level,\r\n            {\r\n                originalException: message,\r\n                syntheticException,\r\n                ...hint,\r\n                event_id: eventId,\r\n            },\r\n            this,\r\n        );\r\n\r\n        return eventId;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    public captureEvent(event: Event, hint?: EventHint): string {\r\n        const eventId = hint && hint.event_id ? hint.event_id : uuid4();\r\n\r\n        if (!this._client) {\r\n            console.warn('No client configured on scope - will not capture event!');\r\n            return eventId;\r\n        }\r\n\r\n        this._client.captureEvent(event, { ...hint, event_id: eventId }, this);\r\n\r\n        return eventId;\r\n    }\r\n\r\n    /**\r\n     * This will be called on every set call.\r\n     */\r\n    protected _notifyScopeListeners(): void {\r\n        // We need this check for this._notifyingListeners to be able to work on scope during updates\r\n        // If this check is not here we'll produce endless recursion when something is done with the scope\r\n        // during the callback.\r\n        if (!this._notifyingListeners) {\r\n            this._notifyingListeners = true;\r\n            this._scopeListeners.forEach(callback => {\r\n                callback(this);\r\n            });\r\n            this._notifyingListeners = false;\r\n        }\r\n    }\r\n}\r\n"],"names":["uuid4"],"mappings":"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"}